{"items":[{"content":{"body":"# Task Breakdown: Polaroid Movie Catalog\n\n## Overview\n\nTotal Tasks: 15\n\n## Task List\n\n### Infrastructure & Assets\n\n#### Task Group 1: Typography & Dependencies\n\n**Dependencies:** None\n\n- [x] 1.0 Setup Assets and Libraries\n  - [x] 1.1 Add 'Caveat' font to `index.html`\n    - Add Google Fonts link: `https://fonts.googleapis.com/css2?family=Caveat:wght@400;700&display=swap`\n    - Verify font loads in the browser\n  - [x] 1.2 Verify `framer-motion` allows 3D transforms\n    - Ensure version supports `preserve-3d` and `rotateX/Y`\n  - [x] 1.3 Add CSS utility for \"preserve-3d\" if missing in Tailwind\n    - Add `.preserve-3d`, `.backface-hidden` utilities to `index.css` or `tailwind.config.js`\n\n**Acceptance Criteria:**\n\n- 'Caveat' font is available in the app.\n- 3D CSS utilities are verified.\n\n### Core Logic\n\n#### Task Group 2: Media & Storage Logic\n\n**Dependencies:** Task Group 1\n\n- [x] 2.0 Refactor Media Logic\n  - [x] 2.1 Extract upload logic from `MediaUploader.tsx` to a hook `useMediaUpload`\n    - Should handle `supabase.storage.upload`\n    - Should return `{ upload, isUploading, error }`\n    - **Goal**: Reuse this for the Polaroid upload button.\n  - [x] 2.2 Verify `notes-media` bucket policies\n    - Ensure authenticated users can upload and read.\n    - (Skip if already verified by existing Image Block usage, but good to check).\n\n**Acceptance Criteria:**\n\n- Reusable `useMediaUpload` hook exists.\n- MediaUploader is refactored to use this hook (optional cleanup, but highly recommended).\n\n### Frontend Components\n\n#### Task Group 3: Polaroid Component Construction\n\n**Dependencies:** Task Group 2\n\n- [x] 3.0 Build PolaroidBlock Component\n  - [x] 3.1 Create `src/features/notes/components/blocks/PolaroidBlock.tsx`\n    - Basic props interface: `BlockProps`\n    - Render interactive container with `aspect-[3.5/4.2]`\n  - [x] 3.2 Implement \"Front Face\" (Image + Chin)\n    - Image area with `linear-gradient` overlay for gloss.\n    - White \"Chin\" area using 'Caveat' font.\n    - Title and Rating display.\n  - [x] 3.3 Implement 3D Tilt Effect\n    - Use `framer-motion` `useMotionValue` for mouse tracking.\n    - Apply `rotateX` and `rotateY` transforms on hover.\n  - [x] 3.4 Implement \"Back Face\" (Edit Mode)\n    - Textarea for \"Memory/Review\".\n    - Inputs for Date and Location.\n    - \"Done\" button to flip back.\n  - [x] 3.5 Implement \"Flip\" Interaction\n    - Click toggles `isFlipped` state.\n    - Animate `rotateY` 180deg.\n  - [x] 3.6 Integrate \"Developing\" Animation\n    - `initial={{ filter: \"sepia(1) blur(4px)\" }}` -> `animate={{ filter: \"sepia(0) blur(0)\" }}`.\n\n**Acceptance Criteria:**\n\n- Polaroid looks photo-realistic (shadows, gloss).\n- Tilt effect follows mouse smoothly.\n- Flip interaction works to edit data.\n- Data saves to `onChange` (block content updates).\n\n### Integration\n\n#### Task Group 4: Editor Integration\n\n**Dependencies:** Task Group 3\n\n- [x] 4.0 Integrate into BlockRenderer\n  - [x] 4.1 Update `BlockRenderer.tsx`\n    - Import `PolaroidBlock`.\n    - Add `case 'polaroid':` logic.\n  - [x] 4.2 Update `StyleToolbar.tsx` (or Slash Command)\n    - Add button to insert \"Polaroid\".\n    - Icon: `Camera` or similar from Lucide.\n  - [x] 4.3 Verify Drag-and-Drop\n    - Ensure `dnd-kit` allows dragging the Polaroid block without breaking the tilt physics (might need `dragCancel` on interactive parts).\n\n**Acceptance Criteria:**\n\n- Can insert a Polaroid block from the editor.\n- Can drag and reorder the block.\n- Block persistence works (reload page = data remains).\n\n## Execution Order\n\n1. Typography & Dependencies\n2. Media & Storage Logic\n3. Polaroid Component Construction\n4. Editor Integration","number":1,"repository":"Milov-ai/SexyLove","title":"Feature: Polaroid Movie Catalog","type":"Issue","url":"https://github.com/Milov-ai/SexyLove/issues/1"},"id":"PVTI_lAHODfx4J84BLK7Lzgi51s8","labels":["enhancement","planned"],"repository":"https://github.com/Milov-ai/SexyLove","status":"Done","title":"Feature: Polaroid Movie Catalog"},{"content":{"body":"# Task Breakdown: Smart Enter Behavior\n\n## Overview\n\nTotal Tasks: 2\n\n## Task List\n\n### Frontend Logic\n\n#### Task Group 1: Enter Key Logic & Focus Management\n\n**Dependencies:** None\n\n- [x] 1.0 Implement Smart Enter Logic\n  - [x] 1.1 Write 2-4 focused integration tests for Enter Key behavior\n    - Test case: Pressing Enter on a bullet point creates a new bullet point\n    - Test case: Pressing Enter on a heading creates a paragraph\n    - Test case: Pressing Enter on an indented item creates a sibling at same depth\n  - [x] 1.2 Refactor `handleKeyDown` in `NoteEditor.tsx`\n    - Update `Enter` logic to intelligently determine \"Next Type\"\n      - Bullet -> Bullet\n      - Todo -> Todo (unchecked)\n      - Heading -> Text (standard paragraph)\n      - Quote -> Text (or Quote, depending on preference, usually Text)\n      - Standard -> Standard\n    - Ensure `addSibling` is called with the correct `focusedBlockId` context\n  - [x] 1.3 Verify and Optimize Focus Transition in `BlockRenderer.tsx`\n    - Ensure `autoFocus` prop correctly triggers `.focus()` on the textarea\n    - Ensure `isEditing` state defaults to `true` for newly created blocks to avoid \"double tap\" requirement\n    - Verify `selectionTimeRef` logic allows immediate typing (ghost click protection shouldn't block initial focus)\n  - [x] 1.4 Test Chaining Capability\n    - Manual Test: Press Enter 5 times rapidly. Ensure 5 empty blocks are created and the cursor ends up in the last one.\n    - Fix any race conditions with `setFocusedBlockId` (ensure `setTimeout` value is appropriate, usually 0 is fine, but React 18 batching might need `flushSync` if issues arise)\n  - [x] 1.5 Ensure Feature Tests Pass\n    - Run the 2-4 integration tests from 1.1\n    - Verify manual chaining works seamlessly\n\n**Acceptance Criteria:**\n\n- [ ] Pressing Enter on a List Item creates a new List Item\n- [ ] Pressing Enter on a Heading creates a Paragraph\n- [ ] New block appears at the correct indentation level\n- [ ] New block is immediately focused and in \"Edit Mode\"\n- [ ] Typing can start immediately after pressing Enter (< 50ms delay)\n\n### Testing\n\n#### Task Group 2: Verification\n\n**Dependencies:** Task Group 1\n\n- [ ] 2.0 Feature Verification\n  - [ ] 2.1 Verify Deep Nesting\n    - Create a list 3 levels deep\n    - Press Enter on the deepest item\n    - Verify new item is also 3 levels deep\n  - [ ] 2.2 Verify Mobile Behavior\n    - Simulate mobile view (touch)\n    - Ensure virtual keyboard stays up or re-appears instantly on new block creation\n  - [ ] 2.3 Close-out\n    - Ensure no regressions in standard editing (typing text, deleting blocks)\n\n**Acceptance Criteria:**\n- [ ] Deep nesting works as expected\n- [ ] Mobile experience is smooth","number":2,"repository":"Milov-ai/SexyLove","title":"Feature: Smart Enter Behavior","type":"Issue","url":"https://github.com/Milov-ai/SexyLove/issues/2"},"id":"PVTI_lAHODfx4J84BLK7Lzgi5374","labels":["enhancement","planned"],"linked pull requests":["https://github.com/Milov-ai/SexyLove/pull/3"],"repository":"https://github.com/Milov-ai/SexyLove","status":"Done","title":"Feature: Smart Enter Behavior"},{"content":{"body":"# Task Breakdown: Cinematic Polaroid Block\r\n\r\n## Overview\r\n\r\nTotal Tasks: 15\r\n\r\n## Task List\r\n\r\n### Logic Layer\r\n\r\n#### Task Group 1: Intelligent Metadata Enrichment\r\n\r\n**Dependencies:** None\r\n\r\n- [x] 1.0 Complete Link Resolver enrichment\r\n  - [x] 1.1 Write 2-8 focused tests for IMDb/Letterboxd URL resolution in `link-resolver.ts`\r\n  - [x] 1.2 Add movie-specific regex patterns to `LinkResolver`\r\n  - [x] 1.3 Implement metadata extraction for `director`, `actor`, `genre`, and `runtime`\r\n  - [x] 1.4 Test resolution results against the new tests in 1.1\r\n\r\n**Acceptance Criteria:**\r\n\r\n- IMDb/Letterboxd links return a \"cine_polaroid\" suitable metadata object.\r\n- All 2-8 tests pass.\r\n\r\n### Frontend Components\r\n\r\n#### Task Group 2: CinePolaroidBlock UI Design\r\n\r\n**Dependencies:** Task Group 1\r\n\r\n- [x] 2.0 Complete CinePolaroidBlock UI\r\n  - [x] 2.1 Write 2-8 focused tests for `CinePolaroidBlock` rendering and props management\r\n  - [x] 2.2 Create `CinePolaroidBlock.tsx` reusing tilt/physics from `PolaroidBlock.tsx`\r\n  - [x] 2.3 Style the \"Front Face\" to match `planning/visuals/movie-poster-reference.jpeg` (Bold text, structured list)\r\n  - [x] 2.4 Implement \"Back Face\" with Seen Toggle, Dual Star Ratings, and Handwritten Comment field\r\n  - [x] 2.5 Ensure the block is registered in `BlockRenderer.tsx`\r\n\r\n**Acceptance Criteria:**\r\n\r\n- High-fidelity match to the `Sleepers` poster reference.\r\n- Interactive flip (3D) works smoothly on mobile.\r\n- Ratings and toggle persist to the store.\r\n\r\n#### Task Group 3: Integration & Smart Conversion\r\n\r\n**Dependencies:** Task Group 2\r\n\r\n- [x] 3.0 Complete Editor Integration\r\n  - [x] 3.1 Implement block conversion logic for detection of Movie URLs in standard Link blocks\r\n  - [x] 3.2 Add manual creation option in the block menu/toolbar\r\n  - [x] 3.3 Verify real-time sync across devices for the new block type\r\n\r\n**Acceptance Criteria:**\r\n\r\n- User can convert a link to a Cine-Polaroid with one tap.\r\n- Manual entry works correctly if no link is provided.\r\n\r\n### Testing & Verification\r\n\r\n#### Task Group 4: Final Gap Analysis\r\n\r\n**Dependencies:** Task Groups 1-3\r\n\r\n- [x] 4.0 Final verification and polished UX\r\n  - [x] 4.1 Review the 12-24 tests from previous tasks\r\n  - [x] 4.2 Add up to 5 strategic E2E tests for the \"Happy Path\" (Paste -> Convert -> Rate)\r\n  - [x] 4.3 Run all feature tests and verify aesthetic consistency\r\n\r\n**Acceptance Criteria:**\r\n\r\n- Zero regression in existing Notes functionality.\r\n- Smooth performance on mobile devices.\r\n\r\n## Execution Order\r\n\r\n1. Logic Layer (Task Group 1)\r\n2. UI Design (Task Group 2)\r\n3. Integration (Task Group 3)\r\n4. Verification (Task Group 4)\r\n","number":4,"repository":"Milov-ai/SexyLove","title":"Feature: Cinematic Polaroid Block","type":"Issue","url":"https://github.com/Milov-ai/SexyLove/issues/4"},"id":"PVTI_lAHODfx4J84BLK7Lzgi7SOM","labels":["enhancement","planned"],"repository":"https://github.com/Milov-ai/SexyLove","status":"Done","title":"Feature: Cinematic Polaroid Block"},{"content":{"body":"# Task Breakdown: Text Input Optimization\r\n\r\n## Overview\r\n\r\nTotal Tasks: 9\r\n\r\n## Task List\r\n\r\n### Frontend Refactoring\r\n\r\n#### Task Group 1: State Decoupling & Auto-Save\r\n\r\n**Dependencies:** None\r\n\r\n- [ ] 1.0 Decouple `NoteEditor` state\r\n  - [ ] 1.1 Write 2-8 focused tests for `NoteEditor` state logic\r\n    - Test initial hydration from `note` prop.\r\n    - Test that subsequent `note` prop updates (simulating auto-save echo) do NOT overwrite local state if `lastEdited` is recent.\r\n  - [ ] 1.2 Implement `useDebounce` hook\r\n    - Create `useDebounce` hook (or reuse existing) for `updateNote` calls.\r\n    - Set debounce delay to 1000ms.\r\n  - [ ] 1.3 Refactor `NoteEditor` useEffects\r\n    - Remove the dependency on `note.content` in the block hydration effect after the first render.\r\n    - Implement a `isDirty` or `localLastModified` ref to track local changes.\r\n    - Ensure `updateNote` is called only after the debounce period.\r\n  - [ ] 1.4 Ensure state tests pass\r\n    - Run ONLY the 2-8 tests written in 1.1.\r\n    - Verify that rapid typing does not trigger re-renders from upstream props.\r\n\r\n**Acceptance Criteria:**\r\n\r\n- Typing quickly does not cause cursor jumps.\r\n- Auto-save triggers 1 second after typing stops.\r\n- Local state persists even if `note` prop updates in the background.\r\n\r\n#### Task Group 2: Block Stability & Rendering\r\n\r\n**Dependencies:** Task Group 1\r\n\r\n- [ ] 2.0 Optimize Block Rendering & Identity\r\n  - [ ] 2.1 Write 2-8 focused tests for `BlockRenderer` stability\r\n    - Test that creating a new block (Enter) generates a stable ID.\r\n    - Test that `BlockRenderer` does not re-render siblings when one block updates its content.\r\n  - [ ] 2.2 Enforce Stable IDs\r\n    - Verify `uuidv4` usage in `addBlock` and `handleGlobalKeyDown` in `NoteEditor.tsx`.\r\n    - Ensure no implicit index-based keys are used in lists (only `block.id`).\r\n  - [ ] 2.3 Optimize `BlockRenderer` memoization\r\n    - Profile `BlockRenderer` re-renders.\r\n    - Wrap `onChange`, `onKeyDown`, `onFocus` handlers in `useCallback` with correct dependency arrays.\r\n    - Ensure `BlockRenderer` uses `React.memo` correctly (verify comparison function if needed).\r\n  - [ ] 2.4 Verify fix with manual smoke test\r\n    - Type rapidly in a long note.\r\n    - Create new blocks with Enter.\r\n    - Move blocks via drag-and-drop.\r\n    - Confirm component stability (no disappearances).\r\n  - [ ] 2.5 Ensure rendering tests pass\r\n    - Run ONLY the 2-8 tests written in 2.1.\r\n\r\n**Acceptance Criteria:**\r\n\r\n- `BlockRenderer` only re-renders the specific block being edited.\r\n- New blocks appear instantly and persist.\r\n- Drag-and-drop operations are smooth and data-safe.\r\n\r\n### Testing\r\n\r\n#### Task Group 3: Final Verification\r\n\r\n**Dependencies:** Task Groups 1-2\r\n\r\n- [ ] 3.0 Final Regression Check\r\n  - [ ] 3.1 Analyze text input behavior on mobile\r\n    - Verify fix on the specific Android device (via browser or APK).\r\n  - [ ] 3.2 Verify legacy data compatibility\r\n    - Open an existing old note and ensure it loads/saves correctly without data loss.\r\n\r\n**Acceptance Criteria:**\r\n\r\n- Validated on Mobile view.\r\n- No regression in existing note functionality.\r\n\r\n## Execution Order\r\n\r\n1. State Decoupling & Auto-Save (Task Group 1)\r\n2. Block Stability & Rendering (Task Group 2)\r\n3. Final Verification (Task Group 3)\r\n","number":7,"repository":"Milov-ai/SexyLove","title":"Feature: Text Input Optimization","type":"Issue","url":"https://github.com/Milov-ai/SexyLove/issues/7"},"id":"PVTI_lAHODfx4J84BLK7LzgjAiHM","labels":["enhancement","planned"],"repository":"https://github.com/Milov-ai/SexyLove","status":"Backlog","title":"Feature: Text Input Optimization"}],"totalCount":4}
